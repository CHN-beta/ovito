<?xml version="1.0" encoding="utf-8"?>
<section version="5.0"
         xsi:schemaLocation="http://docbook.org/ns/docbook http://docbook.org/xml/5.0/xsd/docbook.xsd"
         xml:id="particles.modifiers.unwrap_trajectories"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:xs="http://www.w3.org/2001/XMLSchema"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:ns="http://docbook.org/ns/docbook">
  <title>Unwrap trajectories</title>

  <para>
    <informalfigure>
      <informaltable frame="none" colsep="0" rowsep="0">
        <tgroup cols="2">
          <tbody>
            <row valign="bottom">
              <entry>Input:</entry>
              <entry>Output:</entry>
            </row>
            <row valign="top">
            <entry>
		        <mediaobject><imageobject>
		        <imagedata fileref="images/modifiers/unwrap_trajectories_example_before.svg" format="SVG" scale="30" />
		        </imageobject></mediaobject>
              </entry>
              <entry>
		        <mediaobject><imageobject>
		        <imagedata fileref="images/modifiers/unwrap_trajectories_example_after.svg" format="SVG" scale="30" />
		        </imageobject></mediaobject>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </informalfigure>

    Replaces "wrapped" particle coordinates with "unwrapped" coordinates to make the trajectories of particles continuous.
  </para>

  <para>
    The modifier can be applied to a series of simulation frames to "unwrap" the trajectories of the particles.
    To do this, the modifier needs to step through all simulation frames to detect crossings of particles through the
    boundaries of the periodic simulation cell, which are associated with jumps (discontinuities) in the input trajectories.
    The modifier then dynamically adjusts the coordinates of particles that have crossed a periodic boundary to "unfold" their
    trajectories and make them continuous again.
  </para>
  <para>
    The modifier uses the <link xlink:href="https://en.wikipedia.org/wiki/Periodic_boundary_conditions#Practical_implementation:_continuity_and_the_minimum_image_convention">minimum image principle</link>
    to detect transitions of a particle through a periodic boundary of the simulation cell from one frame to the next, i.e. in an incremental fashion.
    After unfolding, the continuous trajectories can span distances larger than the cell dimensions.
  </para>
  <para>
    The unwrapping of trajectories is only performed along those cell directions for which periodic
    boundary conditions (PBC) are enabled. The PBC flags are read from the
    input simulation file if available and can be manually set in the <link linkend="scene_objects.simulation_cell">Simulation cell</link> panel.
  </para>
  <para>
    If the <literal>Periodic Image</literal> particle property is present, which some MD simulation codes store in the trajectory file,
    then the modifier will directly use this information to unwrap the particle trajectories.
  </para>

  <simplesect>
    <title>See also</title>
    <para>
      <pydoc-link href="modules/ovito_modifiers" anchor="ovito.modifiers.UnwrapTrajectoriesModifier"><classname>UnwrapTrajectoriesModifier</classname> (Python API)</pydoc-link>
    </para>
  </simplesect>

</section>
